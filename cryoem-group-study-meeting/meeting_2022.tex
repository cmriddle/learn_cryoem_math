\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{hyperref}
\usepackage{multirow}
\usepackage{ulem}
\usepackage{listings}
\usepackage{url}
\usepackage{longtable}

\lstset{frameround=fttt,language=Python,breaklines=true}


%SetFonts


\title{Online CryoEM Study Group}
\author{Geoffrey Woollard, Vancouver, Canada}
%\date{}							% Activate to display a given date or no date

\begin{document}
\maketitle

\tableofcontents



\pagebreak
\section{Dates and Topics}
Meetings are generally on Thursdays (morning Pacific time, afternoon Eastern time, evening Europe)

\begin{center}
\small
 \begin{longtable}{|| c c p{90mm} ||} 
 \hline
 Date & Time  & Topic \\ [0.5ex] 
 \hline\hline
 Fri 21 Jan 2022 & \tiny{9 AM PST}  & mathy cryoem paper \\ 
  \hline
 Fri 28 Jan 2022 & \tiny{9:15 AM PST}  & \tiny{Guest: Qinwen (Wendy) Huang - Weakly Supervised Learning for Joint Image Denoising and Protein Localization in Cryo-EM} \\ 
 \hline
 Fri 4 Feb 2022 & \tiny{9 AM PST}  & Rotations - encoding of S0(3) \\ 
 \hline
 Fri 11 Feb 2022 & \tiny{9 AM PST}  & \tiny{Baldwin \& Penczek, 2007. Transformations in SPARX and EMAN2}\\ 
 \hline
 Fri 18 Feb 2022 & \tiny{9 AM PST}  &  advanced rotations \\ 
 \hline
 Fri 25 Feb 2022 & \tiny{9 AM PST}  & mathy cryoem paper \\ 
 \hline
 Fri 4 Mar 2022 & \tiny{9 AM PST}  & advanced rotations \\ 
 \hline
 Fri 11 Mar 2022 & \tiny{9 AM PST}  & mathy cryoem paper \\ 
 \hline
 Fri 18 Mar 2022 & \tiny{9 AM PST}  & advanced rotations \\ 
 \hline
 Fri 25 Mar 2022 & \tiny{9 AM PST}  & mathy cryoem paper \\ 
  \hline
\end{longtable}
\end{center}

\pagebreak
\section{General Information}

\subsection{Archived material}

Meetings from 2020-2021 are archived \href{https://github.com/geoffwoollard/learn_cryoem_math/blob/master/cryoem-group-study-meeting/meeting.pdf}{here}. The audience was a mix of beginners and advanced practitioners, and computational methods developers. 

\subsection{Audience and Streams}

Feel free to share this document and direct people to sign up at \url{https://forms.gle/BUeUW14vV4pyQbDDA} so I have the emails in one place. Online meeting links are emailed to those on this list. {\bf Please join the Slack group and ask questions there, rather than emailing me.}

\subsection{Audience}
In 2022, I am catering to a computational methods development audience. I see this group as a way for computational methods developers to get together in a "pre-competitive" learning environment.

{\bf Practitioners $\rightarrow$ computational methods developers}: You are a structural biologist, or biochemist, and perhaps an advanced cryo-EM practitioner. You would like to train in computational methods development, either to do very advanced data processing, or develop your own methods.

{\bf Pure computational discipline $\rightarrow$ cryo-EM computational methods developers}: You have a background in computer science (computer vision, deep learning, statistics, electrical/computer engineering) and would like to develop methods for the "killer application" of cryo-EM.

\subsection{Pre-requisites}
The bar is quite high, and this group is not for all. There are very good resources out there for self-study; see this \href{https://github.com/geoffwoollard/learn_cryoem_math/blob/master/README.md}{annotated a bibliography}. If you have done an undergraduate degree in an advanced computational program (physics, chemistry, computer science, statistics, applied math) or are a PhD student in a computational field, then you are in good company in this group.

\subsection{Scope}

\subsubsection{Math / Computer science}
\begin{enumerate}
	\item Amortized inference, model learning
	\item Physics aware/inspired/infused deep learning
	\item Deep learning of the image formation model (rotation, etc)
	\item Computationally modelling uncertainty in the image formation model
	\item Geometric deep learning and invariance/equivariance in cryo-EM
	\item Computational optimal transport
	\item Computational differential geometry
	\item Optimization
	\item Custom GPU kernels, including gradient for backprop/autodiff
\end{enumerate}

\subsubsection{Physics}
\begin{enumerate}
	\item Electron optics
	\item Higher order CTF aberrations
	\item Multi-slice
	\item Sample damage
	\item Detector physics
	\item Solvation
	\item Poisson-Boltzmann equation
	\item Modelling choices to encode electrostatic / Coulombic density
\end{enumerate}

\subsection{Meeting Format}
The meetings are meant to be more informal that is typical in research talks. The point is to learn and discuss with other learners, experienced practitioners, and experts. They are also more comprehensive than typical journal clubs. We may stick with a papers or series of papers for multiple weeks to sufficiently learn the material.

\subsection{Slack}
We will use the Slack channel 'cryoem\_study\_group' for asynchronous chat. Please join the Slack group and ask questions there, rather than emailing me. You can request a link to join by emailing me.

\subsection{Testimonials}

\begin{itemize}
	\item {\it Suvrajit Maji, Associate Research Scientist at Columbia University Irving Medical Center \& Joachim Frank, Chemistry Nobel Laureate (cryo-EM for biomolecules 2017), Professor of Biochemistry and Molecular Biophysics and Professor of Biological Sciences at Columbia University}. Fortunately, scripts of a tutorial for math underlying single-particle cryo-EM processing are already available in a github repository (15) [\url{https://github.com/geoffwoollard/learn_cryoem_math}, Geoffrey Woollard \& Ricardo Righetto]. These include notebooks on numerous subtopics on the physics of the electron microscope and image formation (electron optics, electron diffraction patterns, contrast-transfer function), on mathematical concepts (Fourier transforms, convolution, coordinate systems and rotations, interpolations, Fourier slice theorem, 3D reconstruction), on Bayesian inference and estimation theory (maximal likelihood, 2D and 3D image classification, covariance), and on some important image processing tools (alignment via cross-correlation, 3D reconstruction via weighted back-projection, resolution estimation via Fourier shell correlation, detector noise modeling). There are simple object models to experiment with and learn about the basics of phase contrast image formation and data processing.
	\item {\it Shayan Shekarforoush, PhD student with Marcus Brubaker and David Fleet, Jan 2021}. I joined this reading group in mid October and I wish I would have done so much earlier. Although I joined when the group was in the middle of reading a fascinating, recently published book in Single-Particle cryoEM, everyone was so welcome that I did not feel I am way behind others. My background is in CS and I do research as a method developer in this field. With that said, I learned a lot from discussions of people with expertise in experimental side of this area. I believe that this group helped me to build a better intuition and now I feel more comfortable with the underlying math and physics of this topic. This group also provided the opportunity to attend talks of prominent researchers in cryoEM where anyone could openly ask their questions and have clear discussions. Looking forward to having more collaborations with the members of this group.
\end{itemize}

\section{Learning Resources}


\begin{enumerate}
 
	\item I have made an annotated bibliography organized thematically \href{https://github.com/geoffwoollard/learn_cryoem_math#resources}{here}.

	\item Coding notebooks to play around with are \href{https://github.com/geoffwoollard/learn_cryoem_math/tree/master/nb}{here}. If there is incompatibility between the notebook and the \href{https://github.com/geoffwoollard/learn_cryoem_math/tree/master/src}{code base} in the repo, that is because the code base has been updated. Older version of the code are available via past commits.
\end{enumerate}

\pagebreak
\section{Upcoming Meetings}


\subsection{25 Feb 2022 - SO(3) - encoding of S0(3)}
\textendash{Pre-reading}
\begin{itemize}
		\item (2013). Hartley et al., Rotation Averaging. \url{https://link.springer.com/content/pdf/10.1007/s11263-012-0601-0.pdf}
			\begin{enumerate}
			\item Introduction
			\item Previous Work on Rotation Averaging
			\item Alternative Pictures of Rotation Space
			\item Distance Measures on SO(3)
			\item Single Rotation Averaging
			\end{enumerate}
\end{itemize}
\textendash {Questions}
\begin{enumerate}
	\item Does the rotation averaging problem arise in cryo-EM? If so, where? What about the conjugate and multiple rotating averaging problems?
	\item Table 2 Relationship between the different metrics on SO(3): Code up the various metrics ($d_{chord}, d_{quat}$) and numerically verify these relationships on some (arbitrary) rotations
	\item A ball in SO(3) is defined in the appendix. To build some intuition, compute the angular distance between $R_1$ and $R_2$ that are (1) about the same axis and differ by angle $\theta$; (2) rotate the same angle (e.g. 5 degrees), but about axes that sweep from the Z-axis, down to the X-axis, through the ZX plane. Relate (1) and (2) to the ball.
	\item Draw a picture illustrating {\bf Proposition 2}.
	\item Code up Algorithm 1 for several rotations. How do you do the $\log$ and $\exp$ in step 3 and 7? Does your mean seem "in the middle"?
%	\item How would you use the "{\bf Closed-Form Algorithm}" that follows {\bf Corollary 2} to solve the rotation averaging problem?
	\item We can average together quaternions to get a new quaterion. This is a solution to the rotation averaging problem using what distance? 
	
\end{enumerate}

\subsection{March/April 2022 - Guest: Ellen Zhong. CryoDRGN2}
\textendash{Pre-reading}
\begin{enumerate}
	\item Zhong, E. D., Lerer, A., Davis, J. H., \& Berger, B. (2021). CryoDRGN2 : Ab initio neural reconstruction of 3D protein structures from real cryo-EM images. Iccv, 4066-4075.
\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item Write out a schematic (computational graph) of CryoDRGN2. What goes into and out of the encoder and decoder?
	\item How could cross validation be encorporated into CryoDRGN? What would count as "out of distribution" for various computational workflows, and how would CryoDRGN perform? 
\end{enumerate}

\subsection{March/April 2022 - Guest: Roy Lederman.}
\textendash{Pre-reading}
\begin{enumerate}
	\item Lederman, R. R. (2017). Numerical Algorithms for the Computation of Generalized Prolate Spheroidal Functions. ArXiv, (1), 1?23.
	\item Lederman, R. R., \& Singer, A. (2017). Continuously heterogeneous hyper-objects in cryo-EM and 3-D movies of many temporal dimensions, 1?33.
\end{enumerate}
%\textendash {Questions}
%\begin{enumerate}
%	\item 
%\end{enumerate}

\pagebreak
\section{Reading list}
\subsection{Advanced treatment of rigid-body rotations (SO(3))}

\textendash {Pre-reading}
\begin{enumerate}
	\item (2022). Bingham Policy Parameterization for 3D Rotations in Reinforcement Learning. \url{https://arxiv.org/pdf/2202.03957.pdf}
		\begin{itemize}
		\item SO(3) distribution
	\end{itemize}
	\item Orthogonal Procrustes problem \url{https://en.wikipedia.org/wiki/Orthogonal_Procrustes_problem}
	\item (2021). Brofos, J. A., Brubaker, M. A., \& Lederman, R. R. Manifold Density Estimation via Generalized Dequantization. \url{https://arxiv.org/pdf/2102.07143.pdf}
	\item (2017). State Estimation for Robotics. State Estimation for Robotics. Cambridge: Cambridge University Press. \url{http://doi.org/10.1017/9781316671528}
	\item (2021). Implicit-PDF: Non-Parametric Representation of Probability Distributions on the Rotation Manifold \url{https://implicit-pdf.github.io/}
	\item (2020). A Smooth Representation of Belief over SO(3) for Deep Rotation Learning with Uncertainty. \url{https://arxiv.org/pdf/2006.01031.pdf}
	\item (2021). Eliminating Topological Errors in Neural Network Rotation Estimation Using Self-selecting Ensembles. \url{https://dl.acm.org/doi/pdf/10.1145/3450626.3459882}
	\item (2021). On the Continuity of Rotation Representations in Neural Networks. \url{https://arxiv.org/pdf/1812.07035.pdf}
	\item (2021). Learning Rotation Invariant Features for Cryogenic Electron Microscopy Image Reconstruction. \url{https://arxiv.org/pdf/2101.03549.pdf}
	\item (2020). SE(3)-Transformers: 3D Roto-Translation Equivariant Attention Networks. \url{https://arxiv.org/pdf/2006.10503.pdf}
	\item (2020). Falorsi, L., de Haan, P., Davidson, T. R., \& Forré, P. Reparameterizing distributions on Lie groups. AISTATS 2019 - 22nd International Conference on Artificial Intelligence and Statistics, 89. \url{https://arxiv.org/pdf/1903.02958.pdf}
	\item (2020). Dmitry Kostyaev. Hands on Tutorials: Better rotation representations for accurate pose estimation. Towards Data Science. \url{https://towardsdatascience.com/better-rotation-representations-for-accurate-pose-estimation-e890a7e1317f}
	\begin{itemize}
		\item Optimization
		\item SO(3) encoding
	\end{itemize}
	
\end{enumerate}



\subsection{Assorted mathy cryoem papers}

\textendash {Pre-reading}
\begin{enumerate}
	\item Tagare, H. D., Kucukelbir, A., Sigworth, F. J., Wang, H., \& Rao, M. (2015). Directly reconstructing principal components of heterogeneous particles from cryo-EM images. Journal of Structural Biology, 191(2), 245?262. \url{http://doi.org/10.1016/j.jsb.2015.05.007}
	\item Zivanov, J., Nakane, T., \& Scheres, S. H. W. (2019). A Bayesian approach to beam-induced motion correction in cryo-EM single-particle analysis. IUCrJ, 6(1), 5?17. \url{http://doi.org/10.1107/S205225251801463X}
	\item Katsevich, E., Katsevich, A., \& Singer, A. (2015). Covariance matrix estimation for the cryo-em heterogeneity problem. SIAM Journal on Imaging Sciences, 8(1), 126-185. \url{http://doi.org/10.1137/130935434}
	\item Penczek, P. A. (2010). Resolution Measures in Molecular Electron Microscopy. In Methods in Enzymology (1st ed., Vol. 482, pp. 73?100). Elsevier Inc. \url{http://doi.org/10.1016/S0076-6879(10)82003-8}
	\item Ede, J. M. (2020). Review: Deep learning in electron microscopy. ArXiv. \url{http://doi.org/10.1088/2632-2153/abd614}
	\item Zhu, D., Wang, X., Fang, Q., Etten, J. L. Van, Rossmann, M. G., Rao, Z., \& Zhang, X. (n.d.). Pushing the resolution limit by correcting the Ewald reconstructions. Nature Communications, (2018), 1-7. \url{http://doi.org/10.1038/s41467-018-04051-9}
	\item Maji, S., Liao, H., Dashti, A., Mashayekhi, G., Ourmazd, A., \& Frank, J. (2020). Propagation of Conformational Coordinates across Angular Space in Mapping the Continuum of States from Cryo-EM Data by Manifold Embedding. Journal of Chemical Information and Modeling, 60(5), 2484?2491. \url{http://doi.org/10.1021/acs.jcim.9b01115}
	\item Zhong, E. D., Lerer, A., Davis, J. H., \& Berger, B. (2021). CryoDRGN2 : Ab initio neural reconstruction of 3D protein structures from real cryo-EM images. Iccv, 4066-4075.
\end{enumerate}

\subsection{Advanced microscopy}

\textendash {Pre-reading}
\begin{enumerate}
	\item Glaeser, R. M., Hagen, W. J. H., Han, B. G., Henderson, R., McMullan, G., \& Russo, C. J. (2021). Defocus-dependent Thon-ring fading. Ultramicroscopy, 222(October 2020), 113213. \url{http://doi.org/10.1016/j.ultramic.2021.113213}
	\item Russo, C. J., \& Egerton, R. F. (2019). Damage in electron cryomicroscopy: Lessons from biology for materials science. MRS Bulletin, 44(12), 935?941. \url{http://doi.org/10.1557/mrs.2019.284}
	\item Russo, C. J., \& Henderson, R. (2018). Ewald sphere correction using a single side-band image processing algorithm. Ultramicroscopy, 187, 26?33. \url{http://doi.org/10.1016/j.ultramic.2017.11.001}
	\item Electron optics textbook chapters (Hawkes and Kasper; Spence; Reimer and Kohl)
\end{enumerate}

%\subsection{20 May 2021 - Sharpen - Electron Optics: Lens Aberations }
%\textendash{Pre-reading}
%\begin{enumerate}
%	\item "2.3 Lens Abberations" (pp. 31-40) in Reimer, L., \& Kohl, H. (2008). Transmission Electron Microscopy Physics of Image Formation. Springer series in optical sciences (Vol. 51). http://doi.org/10.1007/978-0-387-34758-5
%	\end{enumerate}
%%\textendash {Questions}
%%\begin{enumerate}
%%	\item Install 
%%\end{enumerate}

%\subsection{3 June May 2021 - Sharpen - Electron Optics: Electron Waves and Phase Shifts }
%\textendash{Pre-reading}
%\begin{enumerate}
%	\item "3.1 Electron Waves and Phase Shifts" (pp. 45-55) in Reimer, L., \& Kohl, H. (2008). Transmission Electron Microscopy Physics of Image Formation. Springer series in optical sciences (Vol. 51). http://doi.org/10.1007/978-0-387-34758-5
%	\end{enumerate}
%%\textendash {Questions}
%%\begin{enumerate}
%%	\item Install 
%%\end{enumerate}

\pagebreak
\section{Past Meetings}
\subsection{21 Jan 2022 - VESPER: global and local cryo-EM map alignment using local density vectors.}

\textendash {Pre-reading}
\begin{enumerate}
	\item Han, X., Terashi, G., Christoffer, C., Chen, S., \& Kihara, D. (2021). VESPER: global and local cryo-EM map alignment using local density vectors. Nature Communications, 12(1). \url{http://doi.org/10.1038/s41467-021-22401-y}
\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item Consider Figure 1 and the Z-score results. When aligning two different maps, and getting DOT scores, how would one re-scale to a Z-score? And to what end?
	\item Have you developed any algorithms that start from aligned maps? where did the initial alignment arise from?
	\item How do you compare aligning ?by eye? with the algorithms mentioned in the paper, such as the popular fitmap in Chimera. what do you think you are doing in your mind, and how would you break it down into algorithmic steps?
	\item Figure 2i (and text on last paragraph of p. 4) shows a case where VESPR did not perform well. two different proteins were predicted to be close in shape ?because they have an overall similar shape and also because these maps are largely hollow inside, and thus inconsistency inside the maps were not much penalized?. Relate this to the DOT score. What other approaches would not suffer from this?
	
	\item In Table 2 there are some cases where the RMSD goes up (worse alignment) with finer grained sampling (rotation angle and translation). Why might this be happening?
	\item In the Discussion, the authors explain intuitively how cross correlation (CC) and their DOT score result in different alignments: {\it In CC, positions with large absolute density values, such as those in a high-density region in a map, influence more to the overall CC value. On the other hand, for the DOT score the contribution of each aligned position pair is essentially the same because the vectors are normalized to the same length. But this also means that the DOT score can be affected by changes in local gradient caused by small structure variations.}
	
	Consider the following cases and think through how the result might be different.
	\begin{enumerate}
		\item Continuous conformational heterogeneity: Blurred out flexible region with partial density.
		\item Discrete conformational heterogeneity: Mixed discrete states in one map vs one of the partners.
		\item Hinge like displacement (local rigid-body transformation of a domain).
		\item Two maps +/- domain.
	\end{enumerate}
	\item What do you think of the opinion in the Discussion: {\it Note that, in general, the optimal parameter setting for a method differs for each map and the purpose of the computation. Thus, a perfectly fair comparison is not possible, and the comparison shown in this work is to characterize the performance of VESPER but not to rank the methods.} Hint: see {\bf Responses to Comments by Reviewer \#2}, p. 10.
	\item The authors chose a $7 \AA$ grid spacing. Why? How do you suspect the performance of VESPER to change with other grid spacings? Does the method require the same grid spacing when comparing maps? Hint: read the section {\bf Exploration of parameter combinations.}
	\item Reviewer \#1 asked the authors to justify what map-to-map alignment is useful. Why would a researcher want to align maps (vs model-to-model and model-to-map)?
\end{enumerate}

\subsection{28 Jan 2022 - Guest: Qinwen (Wendy) Huang - Weakly Supervised Learning for Joint Image Denoising and Protein Localization in Cryo-EM}

\textendash {Pre-reading}
\begin{enumerate}
	\item Qinwen Huang, Ye Zhou, Hsuan-Fu Liu, \& Alberto Bartesaghi (2021). Weakly Supervised Learning for Joint Image Denoising and Protein Localization in Cryo-EM \url{https://www.mlsb.io/papers_2021/MLSB2021_Weakly_Supervised_Learning_for.pdf}
\end{enumerate}

\textendash {Questions}
\begin{enumerate}
	\item This paper exploits analytical likelihood-prior-posterior conjugacy between gaussian distributions. How could we extend this to Poisson noise with Poisson-Gamma conjugacy? What would be Poisson, and what would be Gamma?
\end{enumerate}

\subsection{4 Feb 2022 - SO(3) - encoding of S0(3)}
\textendash{Pre-reading}
\begin{enumerate}
	\item \url{https://en.wikipedia.org/wiki/Euler_angles#Rotation_matrix}
	\item \href{http://www.close-range.com/docs/Computing_Euler_angles_from_a_rotation_matrix.pdf}{Gregory G. Slabaugh. Computing Euler angles from a rotation matrix}
	\item \href{https://www.coursera.org/lecture/robotics-flight/axis-angle-representations-for-rotations-4hTtQ}{Axis/Angle Representations for Rotations}
	\item \href{https://accio.github.io/AMIDD/assets/2020/04/JRQuine-MathBiophysicsBook.pdf}{Quine, JR. 4. Orthogonal Transformations and Rotations in Mathematical Techniques in Structural Biology, pp. 25-31}
    	\item \href{https://youtu.be/d4EgbgTm0Bg}{Visualizing quaternions (4d numbers) with stereographic projection}
	\item \href{https://youtu.be/zjMuIxRvygQ}{Quaternions and 3d rotation, explained interactively}
	\item \href{https://eater.net/quaternions/}{Visualizing quaternions An explorable video series}
	\item \href{https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation}{Wiki: Quaternions and spatial rotation}
	\item \href{https://maxime-tournier.github.io/notes/quaternions.html}{Maxime Tournier's Research Notes. Quaternions}
\end{enumerate}

\textendash {Questions}
\begin{enumerate}
	\item Problems (e.g. problem 7) from \href{https://accio.github.io/AMIDD/assets/2020/04/JRQuine-MathBiophysicsBook.pdf}{Quine, JR. 4.5 Problems  in {\it  Mathematical Techniques in Structural Biology},  pp. 30-31}
	\item Implement the pseudo-code in Figure 1 of \href{http://www.close-range.com/docs/Computing_Euler_angles_from_a_rotation_matrix.pdf}{Gregory G. Slabaugh. Computing Euler angles from a rotation matrix}, and use it to compute the Euler angles from a rotation matrix.
	\item Go to the \href{https://eater.net/quaternions/video/doublecover}{doublecover} interactive, and select the 4D tab on the bottom. Find the quaternion that corresponds to a rotation of 90 deg in the cw direction about the z axis.
	\item Quaterions can be used to describe the rotation of the point $ r= \langle r_x,r_y,r_x \rangle \in \mathbb{R}^3$ about angle $\theta$ in the direction of vector $\langle q_x,q_y,q_z \rangle$ as follows. $p_{rotated} = q*p*q^{-1}$, where $q = \langle \cos(\theta/2),q_x\sin(\theta/2),q_y\sin(\theta/2),q_j\sin(\theta/2)\rangle$ and \\ $q^{-1}=\langle \cos(-\theta/2),q_x\sin(-\theta/2),q_y\sin(-\theta/2),q_z\sin(-\theta/2) \rangle$ encode the rotation; $\vec r$ is represented as the quaternion $p=(0,r_x,r_y,r_z)$. Question: using pencil and paper, compute the rotation of the point $ r=\langle1,0,0\rangle$ about the z-axis by $\theta=180^{\circ}$ (ccw or cw, it's the same for this angle). Do you get $r=\langle-1,0,0\rangle$? You will have to use the quaternion multiplication table ($ij=k$, etc.), and know how to interconvert quaternions to cartesian 3D vectors.
	\item Study the sections \href{https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Conversion to and from the matrix representation}{Conversion to and from the matrix representation} and \href{https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Performance_comparisons}{Performance comparisons} on the wiki page for \href{https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation}{Quaternions and spatial rotation}. If we want to rotate many xyz points in space with a 3D rotation, what is the efficient way to do this? Taking into account interconversions between different rotation conventions (Euler angles, rotation matrices, axis-angle, and quaternions) how should we efficiently store rotations versus do rotations?
	\item Besides storing and doing rotations, we have to search over rotations. Wikipedia has a section on \href{https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Differentiation_with_respect_to_the_rotation_quaternion}{Differentiation with respect to the rotation quaternion}. Unpack the equation for $\frac{\partial {\bf p'}}{\partial {\bf q}}$. Would this equation ever be useful in cryoEM? When would we want to estimate the rotation by optimization, and how would we do so with this equation?
\end{enumerate}

\subsection{11 Feb 2022 - Transformations in SPARX and EMAN2}
\textendash{Pre-reading}
\begin{enumerate}
	\item (2007). Baldwin, P. R., \& Penczek, P. A. The Transform Class in SPARX and EMAN2. Journal of Structural Biology, 157(1), 250-261. \url{http://doi.org/10.1016/j.jsb.2006.06.002}
	\begin{enumerate}
		\item 2.1. Eulerian angles in different conventions
		\item 2.1.1. Internal representations and usage
		\item 2.2. Composition of rotations, distance between rotations, volume element for rotation parameters
		\item 2.2.1. Composition of rotations
		\item 2.2.2. The similarity between rotations; metric
		\item 2.2.3. Volume element
		\item 2.3. Quasi-uniform sampling of rotation parameters
	\end{enumerate}
\end{enumerate}

\textendash {Questions}
\begin{enumerate}
	\item 2.1: Compare eq. 7 to the treatment in \url{https://en.wikipedia.org/wiki/Rotation_matrix#Rotation_matrix_from_axis_and_angle}. What is $\hat n \hat n$?
	\item 2.1: Show that eq. 8 follows from eq. 7.
	\item 2.1.1: Compute the RHS of eq 17. Multiply two 4x4 matrices of the form eq. 16 and show they are still of the form in eq. 16. What is the new translation of $\bar M $?
	\item 2.2: Derive eqs. 18,19,20,21
	\item 2.2: Derive eq. 23 and the accompanying equation for $(d \hat n)^2$ in the paragraph that follows.
	\item 2.3: Unpack eq. 27. $\delta \theta = \arctan(1/R)$.
	\item 2.3: Connect Figure 1 to eqs. 28,29.
	\item What other ways are there to do uniform sampling on the sphere? 
\end{enumerate}

\end{document}  